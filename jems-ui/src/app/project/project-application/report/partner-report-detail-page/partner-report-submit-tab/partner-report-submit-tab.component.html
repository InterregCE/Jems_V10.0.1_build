<div *ngIf="data$ | async as data" jemsFormLayout class="mt-2">
    <h3>{{'project.application.partner.report.submit.title' | translate }}</h3>
    <div *ngIf="data.userRole.permissions.includes(PermissionsEnum.ProjectReportingEdit) else reportViewPermission">
        <div *ngIf="data.isEditable; else alreadySubmitted">
            <p>{{'project.application.partner.report.submit.description.one' | translate}} : {{'common.label.project.partner.role.shortcut.' + data.partnerReport?.identification?.partnerRole | adaptTranslationKeyByCallType | async | translate : {partner: data.partnerReport?.identification?.partnerNumber + ' ' + data.partnerSummary.abbreviation} }} - {{'project.application.partner.reports.title.number' | translate : {reportNumber: data.partnerReport?.reportNumber} }}</p>
            <p>{{'project.application.partner.report.submit.description.two' | translate}}</p>
        </div>
        <ng-template #alreadySubmitted>
            {{'project.application.partner.report.submit.description.submitted' | translate}}
        </ng-template>
    </div>
    <ng-template #reportViewPermission>
        <p>{{'project.application.partner.report.submit.description.view.mode' | translate}}</p>
    </ng-template>

    <div jemsNoWidthLimit>
        <jems-pending-button *jemsHasPermission="PermissionsEnum.ProjectReportingEdit"
                [confirm]="{title: 'project.application.partner.report.submit.dialog.title', message: 'project.application.partner.report.submit.dialog.message'}"
                [disabled]="data.isView"
                [hidden]="!data.isEditable"
                [pending]="actionPending"
                (clicked)="submitReport(data.projectId, data.partnerSummary.id, data.partnerReport.id)"
                class="mr-2 mt-2">
            {{'project.application.partner.report.button.submit' | translate}}
        </jems-pending-button>
    </div>
    <jems-alert *ngIf="error$ | async as error"
                [show]="!!error.i18nMessage?.i18nKey"
                [type]="Alert.ERROR">
        <jems-api-error-content [error]="error"></jems-api-error-content>
    </jems-alert>
</div>
