<app-form (save)="onSubmit(controls)"
          (discard)="discard()">
    <form appFormLayout id="partner-form" [formGroup]="partnerForm">
        <h3>{{'project.partner.detail.title' | translate}}</h3>

        <mat-form-field *ngIf="!editable && partner.sortNumber">
            <mat-label>{{'project.application.form.partner.table.number' | translate}}</mat-label>
            <input name="sortNumber" formControlName="sortNumber" matInput>
        </mat-form-field>

        <mat-form-field *ngIf="!editable">
            <mat-label>{{'project.partner.role.label' | translate}}</mat-label>
            <input ngModel="{{('common.label.project.partner.role.' + controls?.role?.value) | translate}}"
                   name="role" formControlName="fakeRole" matInput>
        </mat-form-field>

        <div *ngIf="editable">
            <div appLabel>{{'project.partner.role.label' | translate}} *</div>
            <mat-button-toggle-group>
                <mat-button-toggle
                        [checked]="controls?.role.value === RoleEnum.PARTNER"
                        (change)="setRole(RoleEnum.PARTNER)"
                        [value]="RoleEnum.PARTNER">
                    {{'common.label.project.partner.role.PARTNER' | translate}}
                </mat-button-toggle>
                <mat-button-toggle
                        [checked]="controls?.role.value === RoleEnum.LEADPARTNER"
                        (change)="setRole(RoleEnum.LEADPARTNER)"
                        [value]="RoleEnum.LEADPARTNER">
                    {{'common.label.project.partner.role.LEAD_PARTNER' | translate}}
                </mat-button-toggle>
            </mat-button-toggle-group>
            <mat-error>
                <app-form-field-errors
                        [errors]="controls?.role?.errors"
                        [messages]="roleErrors">
                </app-form-field-errors>
            </mat-error>
        </div>

        <mat-form-field>
            <mat-label>{{'project.partner.name.label' | translate}}</mat-label>
            <input name="abbreviation" formControlName="abbreviation" matInput required>
            <mat-error>
                <app-form-field-errors
                        [errors]="controls?.name?.errors"
                        [messages]="abbreviationErrors">
                </app-form-field-errors>
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <mat-label>{{'project.organization.original.name.label' | translate}}</mat-label>
            <input name="nameInOriginalLanguage" formControlName="nameInOriginalLanguage" matInput>
            <mat-error>
                <app-form-field-errors
                        [errors]="controls?.nameInOriginalLanguage?.errors"
                        [messages]="nameInOriginalLanguageErrors">
                </app-form-field-errors>
            </mat-error>
        </mat-form-field>

        <app-multi-language-container [staticLanguages]="[LANGUAGE.EN]">
            <app-multi-language-form-field
                    label="project.organization.english.name.label"
                    formControlName="nameInEnglish"
                    maxLength="100">
            </app-multi-language-form-field>
        </app-multi-language-container>

        <app-multi-language-container>
            <app-multi-language-form-field
                    label="project.organization.department.label"
                    type="textarea"
                    formControlName="department"
                    maxLength="250">
            </app-multi-language-form-field>
        </app-multi-language-container>

        <h4>{{'project.partner.detail.title.legal.financial' | translate}}</h4>

        <mat-form-field>
            <mat-label>{{'project.partner.type' | translate}}</mat-label>
            <mat-select name="partnerType" formControlName="partnerType">
                <mat-option *ngFor="let type of partnerTypeEnums" [value]="type">
                    {{'project.application.form.relevance.target.group.' + type | translate}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field>
            <mat-label>{{'project.partner.legal.status' | translate}}</mat-label>
            <mat-select name="legalStatusId" formControlName="legalStatusId" required>
                <mat-option *ngFor="let status of legalStatuses" [value]="status.id">
                    {{ status.description | translateBySystemLanguage | async }}
                </mat-option>
            </mat-select>
            <mat-error>
                <app-form-field-errors
                        [errors]="controls?.legalStatus?.errors"
                        [messages]="legalStatusErrors">
                </app-form-field-errors>
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <mat-label>{{'project.partner.vat' | translate}}</mat-label>
            <input name="vat" formControlName="vat" matInput>
            <mat-error>
                <app-form-field-errors
                        [errors]="controls?.vat?.errors"
                        [messages]="vatErrors">
                </app-form-field-errors>
            </mat-error>
        </mat-form-field>
        <p>{{'project.partner.recoverVat.intro.text' | translate}}</p>
        <mat-button-toggle-group [disabled]="!editable">
            <mat-button-toggle
                    [checked]="controls?.vatRecovery.value === VatRecoveryEnum.Yes"
                    (change)="setVat(VatRecoveryEnum.Yes)"
                    [value]="VatRecoveryEnum.Yes">
                {{'common.label.project.partner.recoverVat.true' | translate}}
            </mat-button-toggle>
            <mat-button-toggle
                    [checked]="controls?.vatRecovery.value === VatRecoveryEnum.Partly"
                    (change)="setVat(VatRecoveryEnum.Partly)"
                    [value]="VatRecoveryEnum.Partly">
                {{'common.label.project.partner.recoverVat.partly' | translate}}
            </mat-button-toggle>
            <mat-button-toggle
                    [checked]="controls?.vatRecovery.value === VatRecoveryEnum.No"
                    (change)="setVat(VatRecoveryEnum.No)"
                    [value]="VatRecoveryEnum.No">
                {{'common.label.project.partner.recoverVat.false' | translate}}
            </mat-button-toggle>
        </mat-button-toggle-group>
    </form>
</app-form>
