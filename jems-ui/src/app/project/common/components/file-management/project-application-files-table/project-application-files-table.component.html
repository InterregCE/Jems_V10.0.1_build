<ng-container *ngIf="data$ | async as data">

    <jems-file-list-table
            [fileList]="data.fileList"
            [setDescriptionCallback]="setDescriptionCallback"
            [deleteCallback]="deleteCallback"
            (onDownload)="downloadFile($event)"
            (refresh)="fileManagementStore.filesChanged$.next()">
    </jems-file-list-table>

    <jems-paginator (pageIndexChanged)="fileManagementStore.newPageIndex$.next($event)"
                   (pageSizeChanged)="fileManagementStore.newPageSize$.next($event)"
                   *ngIf="data.files.content?.length"
                   [currentPageIndex]="Tables.DEFAULT_INITIAL_PAGE_INDEX"
                   [currentPageSize]="Tables.DEFAULT_INITIAL_PAGE_SIZE"
                   [length]="data.files.totalElements">
    </jems-paginator>

    <div *ngIf="fileManagementStore.canUpload$ | async">
        <input #selectFile (change)="uploadFile($event?.target)" onclick="this.value=null;"
               type="file" [accept]="acceptedFilesTypes">
        <button (click)="selectFile.click()" mat-stroked-button>
            <mat-icon fontSet="material-icons-outlined" class="mr-1">file_upload</mat-icon>{{ 'file.upload.add.new' | translate }}
        </button>
    </div>
</ng-container>

<jems-alert [show]="fileManagementStore.deleteSuccess$ | async"
           [type]="Alert.SUCCESS">
    <p>{{'file.delete.message.successful' | translate}}</p>
</jems-alert>
<jems-alert *ngIf="fileManagementStore.error$ | async as error"
           [show]="!!error"
           [type]="Alert.ERROR">
    <jems-api-error-content [error]="error"></jems-api-error-content>
</jems-alert>
<jems-alert *ngIf="fileSizeOverLimitError$ | async as showError"
           [show]="showError"
           [type]="Alert.ERROR">
    <p>{{'project.file.size.over.limit' | translate}} {{maximumAllowedFileSizeInMB}} MB</p>
</jems-alert>

<ng-template #noFiles>
    <jems-alert [show]="true"
               [type]="Alert.WARNING">
        <p>{{'file.table.no.files' | translate}}</p>
    </jems-alert>
</ng-template>
