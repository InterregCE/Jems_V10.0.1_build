<app-main-page-template [needsCard]="true"
                        *ngIf="details$ | async as details"
                        titleKey="project.application.form.lifecycle.title">
    <div appFormLayout>

        <div appNoWidthLimit>
            <h2>{{details.project.id}} - {{details.project.acronym}}</h2>
            <app-project-application-information appNoWidthLimit
                                                 [project]="details.project">
            </app-project-application-information>
        </div>

        <div *ngIf="projectDetailStore.projectDecisions$ | async as decisions "
             appFormLayout id="project-detail-container">
            <app-project-application-actions appNoWidthLimit></app-project-application-actions>
            <app-project-application-decisions
                    appNoWidthLimit
                    *ngxPermissionsExcept="[Permission.APPLICANT_USER]"
                    [decisions]="decisions"
                    [isThisUserOwner]="details.project.applicant.id === details.user.id"
                    [projectStatus]="project.projectStatus">
            </app-project-application-decisions>
            <app-project-application-assessments
                    appNoWidthLimit
                    *ngxPermissionsExcept="[Permission.APPLICANT_USER]"
                    [decisions]="decisions"
                    [projectStatus]="project.projectStatus">
            </app-project-application-assessments>
        </div>

        <h3 id="applicationFormLifecycleAttachments">{{'file.tab.header' | translate}}</h3>
        <mat-tab-group appNoWidthLimit>
            <mat-tab label="{{'file.tab.application' | translate}}">
                <ng-template matTabContent>
                    <app-project-application-files
                            [projectId]="projectId"
                            [fileType]="fileType.APPLICANTFILE">
                    </app-project-application-files>
                </ng-template>
            </mat-tab>
            <mat-tab *ngIf="projectDetailStore.assessmentFilesVisible$ | async"
                     label="{{'file.tab.assessment' | translate}}">
                <ng-template matTabContent>
                    <app-project-application-files
                            [projectId]="projectId"
                            [fileType]="fileType.ASSESSMENTFILE">
                    </app-project-application-files>
                </ng-template>
            </mat-tab>
        </mat-tab-group>
    </div>
</app-main-page-template>
