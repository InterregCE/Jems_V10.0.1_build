<jems-main-page-template [needsCard]="true" *ngIf="data$ | async as data">
    <div jemsMultiColumnRow class="back-button">
        <a color="primary" class="mr-1" mat-icon-button
           routerLink="../"
           matTooltip="{{ 'payments.payment.to.project.detail.back.tooltip.button' | translate }}"
           aria-label="back">
            <mat-icon class="icon-back" fontSet="material-icons-outlined">arrow_circle_left</mat-icon>
        </a>
        <h3 class="mb-4 put-icon-to-header-line">{{'payments.to.ec.detail.back.button' | translate}}</h3>
    </div>

    <h3 *ngIf="data.paymentDetail?.id" class="payment-header">{{'payments.to.ec.detail.header' | translate : {
        paymentToEcId: data.paymentDetail.id
    } }}</h3>

        <div id="status" class="status-and-action-header">
            <span class="status-label">{{'common.status' | translate}}:</span>
            <span class="ml-1">
                <mat-chip-list class="mr-1 ml-1" aria-label="status">
                    <mat-chip [class.draft]="data.paymentDetail.status === paymentStatusEnum.Draft"
                              [class.finished]="data.paymentDetail.status === paymentStatusEnum.Finished">
                        {{data.paymentDetail.status}}
                    </mat-chip>
                </mat-chip-list>
            </span>

            <span class="finish-button" *ngIf="data.paymentDetail.id">
                 <jems-pending-button
                         [confirm]="{title: 'payments.to.ec.table.action.finalize.dialog.title', message: 'payments.to.ec.table.action.finalize.dialog.message', warnMessage: 'payments.to.ec.table.action.finalize.dialog.warning'}"
                         [disabled]="data.finalizationDisabled"
                         [pending]="finalizationPending$ | async"
                         (clicked)="finalizePaymentApplication(data.paymentDetail.id)">
                    {{'payments.to.ec.table.action.finalize.button' | translate}}
                </jems-pending-button>
            </span>
        </div>


    <mat-tab-group *ngIf="data.userCanView">

        <mat-tab label="{{'payments.to.ec.detail.summary.tab' | translate}}" id="summaryTab" >
            <jems-payments-application-to-ec-summary-tab jemsNoWidthLimit></jems-payments-application-to-ec-summary-tab>
        </mat-tab>

        <mat-tab *ngIf="data.paymentDetail.id" label="{{'payments.to.ec.detail.ftls.tab' | translate}}" id="ftlsTab" >
            <jems-payments-application-to-ec-ftls-tab jemsNoWidthLimit></jems-payments-application-to-ec-ftls-tab>
        </mat-tab>

    </mat-tab-group>

    <jems-alert *ngIf="finalizeError$ | async as error"
                [show]="!!error.i18nMessage?.i18nKey"
                [type]="Alert.ERROR">
        <jems-api-error-content [error]="error"></jems-api-error-content>
    </jems-alert>
</jems-main-page-template>

