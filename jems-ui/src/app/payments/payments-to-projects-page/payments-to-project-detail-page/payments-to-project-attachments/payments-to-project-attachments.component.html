<jems-form *ngIf="data$ | async as data">
    <form jemsFormLayout>
        <h3>{{ 'payments.payment.to.project.detail.attachments.title' | translate }}</h3>

        <jems-file-list-table jemsNoWidthLimit
                              [fileList]="data.attachmentList"
                              (onDownload)="downloadFile($event)"
                              (onDelete)="deleteFile($event)"
                              (onDescriptionChange)="updateDescription($event)"
                              [savingInProgressForId]="savingDescriptionId$ | async">
        </jems-file-list-table>

        <jems-paginator (pageIndexChanged)="fileManagementStore.newPageIndex$.next($event)"
                        (pageSizeChanged)="fileManagementStore.newPageSize$.next($event)"
                        *ngIf="data.attachments.content?.length"
                        [currentPageIndex]="Tables.DEFAULT_INITIAL_PAGE_INDEX"
                        [currentPageSize]="Tables.DEFAULT_INITIAL_PAGE_SIZE"
                        [length]="data.attachments.totalElements">
        </jems-paginator>

        <div *ngIf="data.isPaymentEditable">
            <input #selectFile (change)="uploadFile($event?.target)" onclick="this.value=null;"
                   type="file" [accept]="acceptedFilesTypes" [hidden]="true">
            <button mat-stroked-button (click)="selectFile.click()">
                <mat-icon fontSet="material-icons-outlined" class="mr-1">file_upload</mat-icon>
                {{ 'file.upload.add.new' | translate }}
            </button>
        </div>

        <jems-alert *ngIf="paymentAttachmentsStore.error$ | async as error"
                    [show]="!!error"
                    [type]="Alert.ERROR">
            <jems-api-error-content [error]="error"></jems-api-error-content>
        </jems-alert>
        <jems-alert *ngIf="fileSizeOverLimitError$ | async as showError"
                    [show]="showError"
                    [type]="Alert.ERROR">
            <p>{{'project.file.size.over.limit' | translate}} {{maximumAllowedFileSizeInMB}} MB</p>
        </jems-alert>

    </form>
</jems-form>
