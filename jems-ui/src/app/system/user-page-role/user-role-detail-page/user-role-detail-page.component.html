<app-main-page-template [needsCard]="true" *ngIf="role$ | async as role"
                        titleKey="userRole.breadcrumb.list"
                        [subTitleKey]="roleId ? 'userRole.detail.short' : 'userRole.breadcrumb.create'">
    <app-form (save)="save(role)"
              (discard)="discard(role)">

        <form appFormLayout [formGroup]="userRoleForm">
            <div appMultiColumnRow>
                <mat-form-field appFormFieldWidth="xx-large">
                    <mat-label>{{ 'userRole.table.column.name.name' | translate }}</mat-label>
                    <input formControlName="name" matInput required>
                    <mat-error>
                        <app-form-field-errors [errors]="name?.errors"></app-form-field-errors>
                    </mat-error>
                </mat-form-field>
            </div>

            <div appNoWidthLimit [appTableConfig]="[{maxInRem:13},{}]" formArrayName="permissions">
                <div>
                    <span>{{ 'userRole.table.column.group.name' | translate }}</span>
                    <div></div>
                </div>
                <div appNoWidthLimit *ngFor="let permission of permissions.controls; let i=index;" [formGroupName]="i">
                    <div appNoWidthLimit>{{permission.get('name').value | translate}}</div>
                    <mat-button-toggle-group>
                        <mat-button-toggle
                                [checked]="permission.get('state')?.value === PermissionState.HIDDEN"
                                (change)="changeState(permission, PermissionState.HIDDEN)">
                            {{'Hidden' | translate}}
                        </mat-button-toggle>
                        <mat-button-toggle
                                [checked]="permission.get('state')?.value === PermissionState.VIEW"
                                (change)="changeState(permission, PermissionState.VIEW)">
                            {{'View' | translate}}
                        </mat-button-toggle>
                        <mat-button-toggle
                                [checked]="permission.get('state')?.value === PermissionState.EDIT"
                                (change)="changeState(permission, PermissionState.EDIT)">
                            {{'Edit' | translate}}
                        </mat-button-toggle>
                    </mat-button-toggle-group>
                </div>
            </div>
        </form>
    </app-form>
</app-main-page-template>

