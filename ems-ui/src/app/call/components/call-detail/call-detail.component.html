<a *ngIf="call?.id" [routerLink]="['/calls']">&lt; Back to List of Calls</a>
<br>
<form [formGroup]="callForm" class="container">
    <h4 class="col-md-12">Call Configuration</h4>
    <mat-form-field class="field col-md-12">
        <mat-label>Call name</mat-label>
        <input name="name" formControlName="name" matInput placeholder="Call name" required>
        <mat-error>
            <app-form-field-errors
                    [errors]="callForm?.controls?.name?.errors"
                    [messages]="nameErrors">
            </app-form-field-errors>
        </mat-error>
    </mat-form-field>

    <mat-form-field class="field col-md-6">
        <mat-label>Start Date</mat-label>
        <input required formControlName="startDate" matInput name="startDate"
               [max]="callForm?.controls?.endDate?.value"
               [ngxMatDatetimePicker]="start">
        <mat-datepicker-toggle matSuffix [for]="start">
        </mat-datepicker-toggle>
        <ngx-mat-datetime-picker #start></ngx-mat-datetime-picker>
        <mat-error>
            <app-form-field-errors
                    [errors]="callForm?.controls?.startDate?.errors"
                    [messages]="startDateErrors">
            </app-form-field-errors>
        </mat-error>
    </mat-form-field>

    <mat-form-field class="field col-md-6">
        <mat-label>End Date</mat-label>
        <input required formControlName="endDate" matInput name="endDate"
               [min]="callForm?.controls?.startDate?.value"
               [ngxMatDatetimePicker]="end">
        <mat-datepicker-toggle matSuffix [for]="end">
        </mat-datepicker-toggle>
        <ngx-mat-datetime-picker #end></ngx-mat-datetime-picker>
        <mat-error>
            <app-form-field-errors
                    [errors]="callForm?.controls?.endDate?.errors"
                    [messages]="endDateErrors">
            </app-form-field-errors>
        </mat-error>
    </mat-form-field>

    <mat-form-field class="field col-md-12">
        <mat-label>Description</mat-label>
        <textarea formControlName="description" matInput name="description">
        </textarea>
        <mat-error>
            <app-form-field-errors
                    [errors]="callForm?.controls?.description?.errors"
                    [messages]="descriptionErrors">
            </app-form-field-errors>
        </mat-error>
    </mat-form-field>

    <ng-container *ngIf="!published">
        <button mat-raised-button color="secondary"
                (click)="cancel.emit()">
            Cancel
        </button>
        <button mat-raised-button color="primary"
                [disabled]="callForm.invalid"
                (click)="onSubmit()">
            Save
        </button>
        <button *ngIf="call?.id" mat-raised-button color="primary"
                [disabled]="callForm.invalid"
                (click)="publishCall()">
            Publish Call
        </button>
    </ng-container>
    <app-alert *ngIf="error$ | async as error"
               [show]="!submitted && !!error.i18nKey"
               [type]="Alert.ERROR">
        <p>{{error.i18nKey | translate}}</p>
    </app-alert>
</form>

