<div *ngxPermissionsOnly="[Permission.ADMINISTRATOR]">
    <a [routerLink]="['/user']">&lt; {{'user.detail.page.back' | translate}}</a>
</div>
<div class="container vertical-center">
    <span class="title-text">{{'user.detail.page.title' | translate}}</span>
    <button *ngIf="!editMode" class="edit-data-button" mat-raised-button
            type="submit"
            (click)="enterEditMode()">
        edit user data
    </button>
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()" autocomplete="off">
        <mat-form-field class="field">
            <mat-label>Name</mat-label>
            <input name="name" formControlName="name" matInput placeholder="Name" required>
            <mat-error>
                <app-form-field-errors
                        [errors]="userForm?.controls?.name?.errors"
                        [messages]="nameErrors">
                </app-form-field-errors>
            </mat-error>
        </mat-form-field>
        <mat-form-field class="field">
            <mat-label>Surname</mat-label>
            <input name="surname" formControlName="surname" matInput placeholder="Surname" required>
            <mat-error>
                <app-form-field-errors
                        [errors]="userForm?.controls?.surname?.errors"
                        [messages]="surnameErrors">
                </app-form-field-errors>
            </mat-error>
        </mat-form-field>
        <mat-form-field class="field">
            <mat-label>Email</mat-label>
            <input name="email" formControlName="email" matInput placeholder="Email" required>
            <mat-error>
                <app-form-field-errors
                        [errors]="userForm?.controls?.email?.errors"
                        [messages]="emailErrors">
                </app-form-field-errors>
            </mat-error>
        </mat-form-field>
        <div *ngxPermissionsOnly="[Permission.ADMINISTRATOR]" class="form-group">
            <app-user-role-form-field
                    [userRole]="user?.userRole"
                    [roleControl]="userForm?.controls?.role"
                    [roles]="userRoles"
                    [editMode]="editMode">
            </app-user-role-form-field>
        </div>
        <div *ngIf="editMode">
            <button mat-raised-button
                    type="submit"
                    (click)="enterViewMode()">
                cancel
            </button>
            <button mat-raised-button
                    color="primary"
                    type="submit"
                    [disabled]="userForm.invalid || submitted">
                save
            </button>
        </div>
        <app-form-validation
                [success]="success$ | async"
                [successMessage]="'user.detail.save.success'"
                [validationError]="validationError">
        </app-form-validation>
    </form>
</div>
